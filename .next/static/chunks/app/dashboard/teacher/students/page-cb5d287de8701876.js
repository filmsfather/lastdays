(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6157],{63:(e,s,t)=>{"use strict";var l=t(7260);t.o(l,"useRouter")&&t.d(s,{useRouter:function(){return l.useRouter}})},6654:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var l=t(5155),a=t(2115),r=t(63),d=t(2619),c=t.n(d);function n(){let e=(0,r.useRouter)(),[s,t]=(0,a.useState)(null),[d,n]=(0,a.useState)([]),[i,x]=(0,a.useState)(!0),[h,m]=(0,a.useState)(null);return((0,a.useEffect)(()=>{!async function(){try{let s=await fetch("/api/auth/me");if(!s.ok)return void e.push("/login");let l=await s.json();if(!l.success||!l.user||"teacher"!==l.user.role)return void e.push("/login");t(l.user)}catch(s){console.error("Auth check failed:",s),e.push("/login")}}()},[e]),(0,a.useEffect)(()=>{!async function(){if(s)try{x(!0),m(null);let e=await fetch("/api/teacher/students"),s=await e.json();if(!e.ok||!s.success)throw Error(s.error||"학생 데이터를 불러오는데 실패했습니다.");n(s.classStats)}catch(e){console.error("학생 데이터 조회 실패:",e),m(e instanceof Error?e.message:"알 수 없는 오류가 발생했습니다.")}finally{x(!1)}}()},[s]),i)?(0,l.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"학생 데이터를 불러오는 중..."})]})}):h?(0,l.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center max-w-md",children:[(0,l.jsx)("div",{className:"text-red-400 mb-4",children:(0,l.jsx)("svg",{className:"mx-auto h-12 w-12",fill:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})})}),(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"오류가 발생했습니다"}),(0,l.jsx)("p",{className:"text-gray-500 mb-4",children:h}),(0,l.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"다시 시도"})]})}):s?(0,l.jsx)("div",{className:"min-h-screen bg-gray-100",children:(0,l.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"학생 관리"}),(0,l.jsx)("p",{className:"text-gray-600",children:"반별 학생 현황 및 관리"}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:[s.name," 선생님 • ",s.class_name]})]}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[(0,l.jsx)(c(),{href:"/dashboard/teacher/today",className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"오늘 스케줄"}),(0,l.jsx)(c(),{href:"/dashboard/teacher",className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"메인 대시보드"})]})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"전체 반 수"}),(0,l.jsxs)("p",{className:"text-3xl font-bold text-blue-600",children:[d.length,"개 반"]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"전체 학생 수"}),(0,l.jsxs)("p",{className:"text-3xl font-bold text-green-600",children:[d.reduce((e,s)=>e+s.students.length,0),"명"]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"평균 이용권"}),(0,l.jsxs)("p",{className:"text-3xl font-bold text-purple-600",children:[d.length>0?Math.round(d.reduce((e,s)=>e+s.students.reduce((e,s)=>e+s.remaining_tickets,0),0)/d.reduce((e,s)=>e+s.students.length,0)):0,"장"]})]})]}),0===d.length?(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[(0,l.jsx)("div",{className:"text-gray-400 mb-4",children:(0,l.jsx)("svg",{className:"mx-auto h-12 w-12",fill:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{d:"M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zM4 18v-4h3v4h2v-4h3v4h2v-4h3v4h2V8H2v10h2z"})})}),(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"등록된 학생이 없습니다"}),(0,l.jsx)("p",{className:"text-gray-500",children:"학생들이 가입하면 여기에 표시됩니다"})]}):(0,l.jsx)("div",{className:"space-y-6",children:d.map(e=>(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,l.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:e.class_name}),(0,l.jsxs)("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:[e.students.length,"명"]})]})}),(0,l.jsx)("div",{className:"p-6",children:(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.students.map(e=>(0,l.jsxs)(c(),{href:"/dashboard/teacher/students/".concat(e.id),className:"block p-4 border border-gray-200 rounded-lg hover:border-blue-300 hover:shadow-md transition-all cursor-pointer",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-800 text-lg",children:e.name}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.class_name})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"보유 이용권"}),(0,l.jsxs)("p",{className:"text-lg font-bold ".concat(e.remaining_tickets>=5?"text-green-600":e.remaining_tickets>=2?"text-yellow-600":"text-red-600"),children:[e.remaining_tickets,"장"]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"학습 현황"}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:"최근 활동을 확인하세요"})]}),(0,l.jsx)("div",{className:"mt-3 text-right",children:(0,l.jsx)("span",{className:"text-xs text-blue-500",children:"자세히 보기 →"})})]},e.id))})})]},e.class_name))}),(0,l.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6",children:[(0,l.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"도움말"}),(0,l.jsxs)("div",{className:"text-sm text-blue-700 space-y-1",children:[(0,l.jsx)("p",{children:"• 각 학생 카드를 클릭하면 상세한 피드백 히스토리를 확인할 수 있습니다"}),(0,l.jsxs)("p",{children:["• 이용권 색상: ",(0,l.jsx)("span",{className:"text-green-600 font-medium",children:"초록(5장 이상)"}),", ",(0,l.jsx)("span",{className:"text-yellow-600 font-medium",children:"노랑(2-4장)"}),", ",(0,l.jsx)("span",{className:"text-red-600 font-medium",children:"빨강(1장 이하)"})]}),(0,l.jsx)("p",{children:"• 배지는 학생의 최근 성취를 나타냅니다 (만점, 일발, 향상, 꾸준, 도전)"})]})]})]})}):null}},9831:(e,s,t)=>{Promise.resolve().then(t.bind(t,6654))}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=9831)),_N_E=e.O()}]);