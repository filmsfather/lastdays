(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7949],{63:(e,s,t)=>{"use strict";var r=t(7260);t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}})},1492:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var r=t(5155),a=t(2115),l=t(2663),o=t(2619),n=t.n(o),i=t(63);function c(){let e=(0,i.useRouter)(),[s,t]=(0,a.useState)(null),[o,c]=(0,a.useState)(0),[d,x]=(0,a.useState)([]),[m,h]=(0,a.useState)([]),[u,b]=(0,a.useState)([]),[g,p]=(0,a.useState)([]),[f,j]=(0,a.useState)(!0),[y,N]=(0,a.useState)(null),[v,w]=(0,a.useState)(new Date),[k,S]=(0,a.useState)(null),[C,D]=(0,a.useState)(!1),[L,P]=(0,a.useState)(null),[I,R]=(0,a.useState)(!1),[_,M]=(0,a.useState)(""),[V,T]=(0,a.useState)(""),[E,O]=(0,a.useState)(!1);(0,a.useEffect)(()=>{!async function(){try{let e=await fetch("/api/auth/me"),s=await e.json();if(s.success){if(t(s.user),"student"!==s.user.role){l.oR.error("학생만 접근 가능한 페이지입니다."),window.location.href="/login";}}else{window.location.href="/login";}}catch(e){console.error("사용자 정보 조회 실패:",e),window.location.href="/login"}}()},[]);let z=e=>{let[s,t,r]=$(e).split("-").map(Number),a=new Date(s,t-1,r),l=a.getDay(),o=a.getDate()-l+(0===l?-6:1),n=new Date(a);return n.setDate(o),n},B=e=>{let s=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(s,"-").concat(t,"-").concat(r)};(0,a.useEffect)(()=>{s&&w(z(new Date))},[s]),(0,a.useEffect)(()=>{s&&v&&e();async function e(){j(!0);try{await Promise.all([W(),A(),F(),H(),J()])}catch(e){console.error("데이터 로드 실패:",e),l.oR.error("데이터를 불러오는 중 오류가 발생했습니다.")}finally{j(!1)}}},[s,v]);let W=async()=>{try{let e=await fetch("/api/me/tickets"),s=await e.json();s.success&&c(s.remaining_tickets)}catch(e){console.error("이용권 조회 실패:",e)}},A=async()=>{try{let e=new Date(v);e.setDate(e.getDate()+6);let s=v.toISOString().split("T")[0],t=e.toISOString().split("T")[0],r=await fetch("/api/slots?from=".concat(s,"&to=").concat(t)),a=await r.json();a.success&&x(a.slots)}catch(e){console.error("슬롯 조회 실패:",e)}},F=async()=>{try{let e=await fetch("/api/reservations"),s=await e.json();s.success&&h(s.reservations)}catch(e){console.error("예약 조회 실패:",e)}},H=async e=>{try{let s=await fetch(e?"/api/student/problems?date=".concat(e):"/api/student/problems"),t=await s.json();t.success&&b(t.problems)}catch(e){console.error("문제 조회 실패:",e)}},J=async()=>{try{console.log("Fetching sessions...");let s=await fetch("/api/student/sessions"),t=await s.json();if(console.log("Sessions response:",t),t.success){var e;p(t.sessions||[]),console.log("Sessions loaded:",(null==(e=t.sessions)?void 0:e.length)||0)}else console.error("Sessions fetch failed:",t.error)}catch(e){console.error("세션 조회 실패:",e)}},Y=async()=>{if(!y||o<=0)return void l.oR.error("슬롯을 선택하고 이용권을 확인해주세요.");try{let e=await fetch("/api/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slotId:y})}),s=await e.json();s.success?(l.oR.success("예약이 생성되었습니다."),N(null),await Promise.all([W(),A(),F()])):l.oR.error(s.error||"예약 생성에 실패했습니다.")}catch(e){console.error("예약 생성 실패:",e),l.oR.error("예약 생성 중 오류가 발생했습니다.")}},K=async e=>{if(confirm("예약을 취소하시겠습니까?"))try{let s=await fetch("/api/reservations/".concat(e),{method:"DELETE"}),t=await s.json();t.success?(l.oR.success("예약이 취소되고 이용권이 환불되었습니다."),await Promise.all([W(),A(),F()])):l.oR.error(t.error||"예약 취소에 실패했습니다.")}catch(e){console.error("예약 취소 실패:",e),l.oR.error("예약 취소 중 오류가 발생했습니다.")}},Z=async()=>{if(!k||!L)return void l.oR.error("문제를 선택해주세요.");try{console.log("문제 선택 요청:",{currentReservationId:L,selectedProblem:k});let r=await fetch("/api/reservations/".concat(L,"/select-problem"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({problemId:k})});if(console.log("API 응답 상태:",r.status,r.statusText),console.log("API 응답 헤더:",Object.fromEntries(r.headers.entries())),!r.ok){if(console.error("API 에러 응답:",r.status,r.statusText),405===r.status)return void l.oR.error("API 경로 오류가 발생했습니다. 개발자에게 문의하세요.");let e=await r.text();console.error("에러 응답 내용:",e);try{let s=JSON.parse(e);l.oR.error(s.error||"문제 선택에 실패했습니다.")}catch(s){l.oR.error("서버 오류 (".concat(r.status,"): ").concat(e||"알 수 없는 오류"))}return}let a=await r.json();if(console.log("API 응답 데이터:",a),a.success){var s,t;if(l.oR.success("문제가 선택되고 세션이 생성되었습니다."),D(!1),S(null),P(null),await Promise.all([F(),J()]),(null==(s=a.session)?void 0:s.id)||a.sessionId){let s=(null==(t=a.session)?void 0:t.id)||a.sessionId;console.log("피드백 페이지로 이동:",s),e.push("/session/".concat(s,"/feedback"))}}else l.oR.error(a.error||"문제 선택에 실패했습니다.")}catch(e){console.error("문제 선택 실패 (Catch):",e),l.oR.error("문제 선택 중 오류가 발생했습니다: ".concat(e instanceof Error?e.message:"알 수 없는 오류"))}},$=e=>{let s=e||new Date;return new Intl.DateTimeFormat("fr-CA",{timeZone:"Asia/Seoul"}).format(s)},q=e=>{let s=$();return e.slot.date>=s},G=async()=>{if(!_||!V)return void l.oR.error("현재 PIN과 새 PIN을 모두 입력해주세요.");if(4!==V.length||!/^\d{4}$/.test(V))return void l.oR.error("새 PIN은 4자리 숫자여야 합니다.");O(!0);try{let e=await fetch("/api/change-pin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPin:_,newPin:V})}),s=await e.json();s.success?(l.oR.success("PIN이 성공적으로 변경되었습니다."),R(!1),M(""),T("")):l.oR.error(s.error||"PIN 변경에 실패했습니다.")}catch(e){console.error("PIN 변경 실패:",e),l.oR.error("PIN 변경 중 오류가 발생했습니다.")}finally{O(!1)}},Q=e=>new Date(e).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"}),U=e=>e.substring(0,5),X=e=>"AM"===e?"오전":"오후";return f?(0,r.jsx)("div",{className:"min-h-screen gradient-bg flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center animate-fade-in",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600 font-medium",children:"데이터를 불러오는 중..."})]})}):(0,r.jsxs)("div",{className:"min-h-screen gradient-bg",children:[(0,r.jsx)("nav",{className:"bg-white/80 backdrop-blur-sm border-b border-white/20 sticky top-0 z-40",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-xl flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white font-bold text-sm",children:"L"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-lg font-bold text-gray-900",children:"Last Days"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"학생 대시보드"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(n(),{href:"/dashboard/student/history",className:"btn-ghost",children:"학습 히스토리"}),(0,r.jsx)("button",{onClick:()=>R(!0),className:"btn-ghost",children:"PIN 변경"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 px-4 py-2 bg-blue-50 rounded-xl border border-blue-100",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"text-blue-600 font-medium",children:"보유 이용권"}),(0,r.jsx)("span",{className:"ml-2 text-2xl font-bold text-blue-700",children:o}),(0,r.jsx)("span",{className:"text-blue-600 text-sm",children:"장"})]})]})]})]})})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[(0,r.jsxs)("div",{className:"mb-8 animate-fade-in",children:[(0,r.jsxs)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:["안녕하세요, ",(0,r.jsx)("span",{className:"bg-gradient-to-r from-blue-600 to-blue-600 bg-clip-text text-transparent",children:null==s?void 0:s.name}),"님!"]}),(0,r.jsxs)("p",{className:"text-xl text-gray-600",children:[null==s?void 0:s.className," • 체계적인 학습으로 목표를 달성해보세요"]})]}),(0,r.jsxs)("div",{className:"card animate-slide-up",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"예약 캘린더"}),(0,r.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8 p-4 bg-gradient-to-r from-gray-50 to-blue-50 rounded-xl border border-gray-200",children:[(0,r.jsxs)("button",{onClick:()=>{let e=new Date(v);e.setDate(e.getDate()-7),w(e)},className:"flex items-center px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-white rounded-lg transition-all shadow-sm hover:shadow-md",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"이전 주"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-gray-900",children:[v.getFullYear(),"년 ",v.getMonth()+1,"월 ",v.getDate(),"일 주간"]}),(0,r.jsx)("button",{onClick:()=>{w(z(new Date))},className:"px-4 py-2 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors shadow-sm",children:"이번 주"})]}),(0,r.jsxs)("button",{onClick:()=>{let e=new Date(v);e.setDate(e.getDate()+7),w(e)},className:"flex items-center px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-white rounded-lg transition-all shadow-sm hover:shadow-md",children:["다음 주",(0,r.jsx)("svg",{className:"w-5 h-5 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),m.filter(q).length>0&&(0,r.jsxs)("div",{className:"mb-8 p-6 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl border border-blue-200",children:[(0,r.jsxs)("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center mr-3",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),"내 예약 현황 (",m.filter(q).length,"개)"]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.filter(q).map(e=>{let s=e.slot.date===$();return(0,r.jsxs)("div",{className:"p-4 rounded-xl border-2 transition-all duration-200 ".concat("completed"===e.status?"bg-green-50 border-green-200":e.problem_selected?"bg-blue-50 border-blue-200":s?"bg-amber-50 border-amber-200":"bg-white border-gray-200"),children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-semibold text-gray-800 text-sm",children:[Q(e.slot.date),s&&(0,r.jsx)("span",{className:"ml-2 text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"오늘"})]}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm",children:[X(e.slot.session_period)," ",U(e.slot.time_slot)]}),(0,r.jsxs)("p",{className:"text-gray-500 text-xs",children:[e.slot.teacher.name," 선생님"]})]}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-lg text-xs font-medium ".concat("completed"===e.status?"bg-green-100 text-green-800":e.problem_selected?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:"completed"===e.status?"완료":e.problem_selected?"문제선택완료":"예약됨"})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[s&&!e.problem_selected&&(0,r.jsx)("button",{onClick:async()=>{P(e.id),await H(e.slot.date),D(!0)},className:"flex-1 btn-primary text-xs py-2",children:"문제 선택"}),"active"===e.status&&(0,r.jsx)("button",{onClick:()=>K(e.id),className:"flex-1 px-3 py-2 bg-red-500 text-white text-xs rounded-lg font-medium hover:bg-red-600 transition-colors",children:"취소"})]})]},e.id)})})]}),(0,r.jsx)("div",{className:"grid grid-cols-7 gap-2 mb-6",children:["월요일","화요일","수요일","목요일","금요일","토요일","일요일"].map((e,s)=>(0,r.jsx)("div",{className:"text-center p-4 text-lg font-bold text-gray-700 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl border border-gray-200",children:e},e))}),(0,r.jsx)("div",{className:"grid grid-cols-7 gap-2 max-h-[600px] overflow-y-auto custom-scrollbar",children:(e=>{let s=[];for(let t=0;t<7;t++){let r=new Date(e);r.setDate(e.getDate()+t),s.push(r)}return s})(v).map((e,s)=>{let t=(e=>{let s=B(e);return d.filter(e=>e.date===s&&e.available)})(e),a=B(e),l=m.filter(e=>e.slot.date===a),o=$(),n=a===o,i=a<o;return(0,r.jsxs)("div",{className:"min-h-48 p-4 border-2 rounded-2xl transition-all duration-200 ".concat(i?"bg-gray-50 opacity-60":"bg-white hover:shadow-md"," ").concat(n?"border-blue-400 bg-blue-50 shadow-lg":"border-gray-200"),children:[(0,r.jsxs)("div",{className:"text-lg font-bold mb-4 text-center pb-2 border-b ".concat(n?"text-blue-700 border-blue-200":"text-gray-700 border-gray-200"),children:[(e=>{let s=e.getMonth()+1,t=e.getDate(),r=["일","월","화","수","목","금","토"][e.getDay()];return"".concat(s,"/").concat(t," (").concat(r,")")})(e),n&&(0,r.jsx)("div",{className:"text-xs text-blue-600 font-normal",children:"오늘"})]}),l.map(e=>(0,r.jsxs)("div",{className:"mb-3 p-3 rounded-xl border-2 ".concat("completed"===e.status?"bg-green-100 border-green-300":e.problem_selected?"bg-blue-100 border-blue-300":"bg-amber-100 border-amber-300"),children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-gray-800",children:"내 예약 \uD83D\uDCC5"}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[X(e.slot.session_period)," ",U(e.slot.time_slot)]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[e.slot.teacher.name," 선생님"]})]},"reservation-".concat(e.id))),0===t.length&&0===l.length?(0,r.jsxs)("div",{className:"text-center mt-8",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-2",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:i?"지난 날":"예약 없음"})]}):(0,r.jsx)("div",{className:"space-y-1",children:t.map(e=>(0,r.jsx)("div",{className:"p-2 rounded-lg cursor-pointer transition-all duration-200 border ".concat(y===e.id?"bg-green-100 border-green-400 shadow-sm":"bg-gray-50 hover:bg-gray-100 border-gray-200 hover:border-gray-300"," ").concat(i?"cursor-not-allowed opacity-50":""),onClick:()=>!i&&N(e.id),children:(0,r.jsxs)("div",{className:"font-medium text-gray-800 text-sm text-center",children:[X(e.session_period)," ",U(e.time_slot)]})},e.id))})]},s)})}),(0,r.jsx)("div",{className:"mt-8 pt-6 border-t-2 border-gray-200",children:(0,r.jsx)("button",{onClick:Y,disabled:!y||o<=0,className:"w-full py-6 px-8 rounded-2xl font-bold text-xl transition-all duration-300 ".concat(y&&o>0?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-xl hover:shadow-2xl transform hover:-translate-y-2 hover:scale-105":"bg-gray-200 text-gray-500 cursor-not-allowed"),children:o<=0?"이용권이 없습니다 \uD83D\uDE14":y?"선택한 시간으로 예약하기 ✨":"시간을 선택해주세요 \uD83D\uDCC5"})})]}),(0,r.jsxs)("div",{className:"card animate-slide-up",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"피드백 세션"}),(0,r.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]}),0===g.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"생성된 피드백 세션이 없습니다"}),(0,r.jsx)("p",{className:"text-gray-500",children:"문제를 선택하면 피드백 세션이 생성됩니다"})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(s=>(0,r.jsxs)("div",{className:"p-5 rounded-2xl border-2 transition-all duration-200 hover:shadow-lg ".concat("completed"===s.status?"bg-green-50 border-green-200":"feedback_pending"===s.status?"bg-blue-50 border-blue-200":"bg-amber-50 border-amber-200"),children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-800 truncate",children:s.problemTitle}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[Q(s.date)," • ",X(s.sessionPeriod)," ",U(s.timeSlot)]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[s.teacherName," 선생님 • ",s.limitMinutes,"분"]})]}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-lg text-xs font-medium ".concat("completed"===s.status?"bg-green-100 text-green-800":"feedback_pending"===s.status?"bg-blue-100 text-blue-800":"bg-amber-100 text-amber-800"),children:"completed"===s.status?"완료":"feedback_pending"===s.status?"피드백 대기":"진행중"})]}),(0,r.jsxs)("div",{className:"mb-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center text-xs",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full mr-2 ".concat(s.hasScore?"bg-green-500":"bg-gray-300")}),(0,r.jsxs)("span",{className:s.hasScore?"text-green-700":"text-gray-500",children:["채점 ",s.hasScore?"완료":"대기중"]}),s.hasScore&&null!==s.finalScore&&(0,r.jsxs)("span",{className:"ml-2 font-medium text-green-700",children:["(",s.finalScore,"점)"]})]}),(0,r.jsxs)("div",{className:"flex items-center text-xs",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full mr-2 ".concat(s.hasFeedback?"bg-green-500":"bg-gray-300")}),(0,r.jsxs)("span",{className:s.hasFeedback?"text-green-700":"text-gray-500",children:["피드백 ",s.hasFeedback?"완료":"대기중"]})]}),(0,r.jsxs)("div",{className:"flex items-center text-xs",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full mr-2 ".concat(s.hasReflection?"bg-green-500":"bg-gray-300")}),(0,r.jsxs)("span",{className:s.hasReflection?"text-green-700":"text-gray-500",children:["복기 ",s.hasReflection?"완료":"작성중"]})]})]}),(0,r.jsx)("button",{onClick:()=>{console.log("피드백 페이지로 이동:","/session/".concat(s.id,"/feedback")),console.log("세션 ID:",s.id),e.push("/session/".concat(s.id,"/feedback"))},className:"w-full py-3 px-4 bg-white border border-gray-300 rounded-xl text-gray-700 font-medium hover:bg-gray-50 hover:border-gray-400 transition-all duration-200",children:"피드백 페이지 보기 →"})]},s.id))})]}),C&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 px-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-3xl p-8 w-full max-w-2xl shadow-2xl animate-slide-up",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:"문제 선택"}),(0,r.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]}),(0,r.jsx)("div",{className:"max-h-80 overflow-y-auto custom-scrollbar mb-8",children:(0,r.jsx)("div",{className:"space-y-4",children:0===u.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,r.jsx)("p",{className:"text-gray-500 text-lg",children:"사용 가능한 문제가 없습니다"})]}):u.map(e=>(0,r.jsx)("div",{className:"p-5 rounded-2xl border-2 cursor-pointer transition-all duration-200 ".concat(k===e.id?"bg-gradient-to-br from-blue-50 to-blue-50 border-blue-300 shadow-medium scale-[1.02]":"bg-white border-gray-200 hover:border-gray-300 hover:shadow-soft hover:scale-[1.01]"),onClick:()=>S(e.id),children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-medium text-gray-800",children:e.title}),(0,r.jsxs)("div",{className:"flex items-center mt-2 space-x-2",children:[(0,r.jsxs)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded",children:["제한시간 ",e.limit_minutes,"분"]}),(0,r.jsxs)("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded",children:["사전열람 ",e.preview_lead_time,"분 전"]})]}),(0,r.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:[e.creator.name," 선생님 • ",e.creator.class_name]})]}),(0,r.jsx)("input",{type:"radio",name:"problem",checked:k===e.id,onChange:()=>S(e.id),className:"h-4 w-4 text-blue-600"})]})},e.id))})}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("button",{onClick:()=>{D(!1),S(null),P(null)},className:"btn-secondary flex-1 py-3",children:"취소"}),(0,r.jsx)("button",{onClick:Z,disabled:!k,className:"flex-1 py-3 px-6 rounded-2xl font-semibold transition-all duration-200 ".concat(k?"bg-blue-600 text-white shadow-medium hover:bg-blue-700 hover:shadow-lg transform hover:-translate-y-0.5":"bg-gray-200 text-gray-500 cursor-not-allowed"),children:"선택하기 ✨"})]})]})}),I&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 px-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-3xl p-8 w-full max-w-md shadow-2xl animate-slide-up",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:"PIN 변경"}),(0,r.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m0 0a2 2 0 012 2m-2-2a2 2 0 00-2 2m2 2v2a2 2 0 01-2 2m-2-2a2 2 0 01-2-2m2-2a2 2 0 012-2m0 0V5a2 2 0 00-2-2m-4 6V4a1 1 0 011-1h4a1 1 0 011 1v2m-6 0a1 1 0 00-1 1v4a1 1 0 001 1m-1-5h2m5 0h2"})})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"현재 PIN"}),(0,r.jsx)("input",{type:"password",maxLength:4,value:_,onChange:e=>M(e.target.value.replace(/[^0-9]/g,"")),placeholder:"현재 4자리 PIN 입력",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-center text-lg font-mono"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"새로운 PIN"}),(0,r.jsx)("input",{type:"password",maxLength:4,value:V,onChange:e=>T(e.target.value.replace(/[^0-9]/g,"")),placeholder:"새로운 4자리 PIN 입력",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-center text-lg font-mono"})]}),(0,r.jsx)("div",{className:"text-sm text-gray-500 p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:(0,r.jsxs)("p",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-4 h-4 text-yellow-600 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.876c1.242 0 2.135-1.13 1.73-2.261L13.956 4.016a1.969 1.969 0 00-3.913 0L3.332 16.739C2.927 17.87 3.82 19 5.062 19z"})}),"PIN은 4자리 숫자여야 하며, 동일한 이름+PIN 조합이 없어야 합니다."]})})]}),(0,r.jsxs)("div",{className:"flex space-x-4 mt-8",children:[(0,r.jsx)("button",{onClick:()=>{R(!1),M(""),T("")},className:"btn-secondary flex-1 py-3",disabled:E,children:"취소"}),(0,r.jsx)("button",{onClick:G,disabled:!_||!V||4!==_.length||4!==V.length||E,className:"flex-1 py-3 px-6 rounded-2xl font-semibold transition-all duration-200 ".concat(_&&V&&4===_.length&&4===V.length&&!E?"bg-blue-600 text-white shadow-medium hover:bg-blue-700 hover:shadow-lg transform hover:-translate-y-0.5":"bg-gray-200 text-gray-500 cursor-not-allowed"),children:E?(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-gray-400 border-t-white rounded-full animate-spin mr-2"}),"변경 중..."]}):"PIN 변경"})]})]})})]})]})}},6413:(e,s,t)=>{Promise.resolve().then(t.bind(t,1492))}},e=>{e.O(0,[2619,2663,8441,1255,7358],()=>e(e.s=6413)),_N_E=e.O()}]);